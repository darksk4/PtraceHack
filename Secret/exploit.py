import r2pipe
import sys
import os


"""
    There is a hidden function in the program
    0x400afe
    which call one parameter
"""


def step(r2):
    r2.cmd('ds')
    r2.cmd('sr rip')


def change_zf_value_to(r2, value):
    r2.cmd('dr zf=' + str(value))
    step(r2)


def define_1_to_127(value):
    r2 = r2pipe.open('./secret_flag.bin', flags=['-wd'])
    r2.cmd('e dbg.profile=secret_flag.rr2')
    r2.cmd('doo; db main')
    r2.cmd('dc')
    r2.cmd('db 0x400996')
    r2.cmd('dc')
    r2.cmd('dr rdi=2')
    r2.cmd('s 0x400afe')
    r2.cmd('dr rip=0x400afe')
    r2.cmd('db 0x400b46')
    r2.cmd('dc')
    r2.cmd('dr rax=0')
    r2.cmd('ds')
    r2.cmd('ds')
    r2.cmd('dr rip')
    r2.cmd('dc')



def main():
    define_1_to_127(0)


if __name__ == "__main__":
    main();
